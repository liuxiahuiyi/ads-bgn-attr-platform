# -*- coding: UTF-8 –*-
from __future__ import division
import re
def convertApplicableAge(age_attr_value):
  age_map = {
    ('71739', u'新生儿'): ('48845', u'0-1个月'),
    ('109145', u'新生'): ('48845', u'0-1个月'),
    ('48845', u'0-1个月'): ('48845', u'0-1个月'),
    ('109146', u'1个月'): ('48845', u'0-1个月'),
    ('109147', u'2个月'): ('67242', u'1-3个月'),
    ('75772', u'3个月'): ('67242', u'1-3个月'),
    ('67242', u'1-3个月'): ('67242', u'1-3个月'),
    ('67187', u'0-3个月'): ('67187', u'0-3个月'),
    ('67188', u'3-6个月'): ('67188', u'3-6个月'),
    ('80421', u'4-6个月'): ('67188', u'3-6个月'),
    ('109148', u'4个月'): ('67188', u'3-6个月'),
    ('109149', u'5个月'): ('67188', u'3-6个月'),
    ('10096', u'0-6个月'): ('10096', u'0-6个月'),
    ('80416', u'6个月以下'): ('10096', u'0-6个月'),
    ('48847', u'6-9个月'): ('48847', u'6-9个月'),
    ('75773', u'6个月'): ('48847', u'6-9个月'),
    ('109150', u'7个月'): ('48847', u'6-9个月'),
    ('109151', u'8个月'): ('48847', u'6-9个月'),
    ('109152', u'9个月'): ('48847', u'6-9个月'),
    ('82228', u'10-12个月'): ('82228', u'10-12个月'),
    ('109153', u'10个月'): ('82228', u'10-12个月'),
    ('109154', u'11个月'): ('82228', u'10-12个月'),
    ('75774', u'12个月'): ('82228', u'10-12个月'),
    ('10097', u'6-12个月'): ('10097', u'6-12个月'),
    ('80422', u'7-12个月'): ('10097', u'6-12个月'),
    ('67253', u'0-1岁'): ('67253', u'0-1岁'),
    ('78037', u'1岁以下'): ('67253', u'0-1岁'),
    ('47967', u'0-9个月'): ('67253', u'0-1岁'),
    ('86147', u'12个月以下'): ('67253', u'0-1岁'),
    ('47417', u'0-12个月'): ('67253', u'0-1岁'),
    ('109487', u'1岁'): ('67253', u'0-1岁'),
    ('23326', u'0-15个月'): ('67253', u'0-1岁'),
    ('47421', u'12-18个月'): ('47421', u'12-18个月'),
    ('109155', u'13个月'): ('47421', u'12-18个月'),
    ('109156', u'14个月'): ('47421', u'12-18个月'),
    ('109157', u'15个月'): ('47421', u'12-18个月'),
    ('109158', u'16个月'): ('47421', u'12-18个月'),
    ('109159', u'17个月'): ('47421', u'12-18个月'),
    ('75775', u'18个月'): ('47421', u'12-18个月'),
    ('47422', u'18-24个月'): ('47422', u'18-24个月'),
    ('109160', u'19个月'): ('47422', u'18-24个月'),
    ('109161', u'20个月'): ('47422', u'18-24个月'),
    ('109162', u'21个月'): ('47422', u'18-24个月'),
    ('109163', u'22个月'): ('47422', u'18-24个月'),
    ('109164', u'23个月'): ('47422', u'18-24个月'),
    ('41261', u'0-2岁'): ('41261', u'0-2岁'),
    ('70449', u'0-3岁'): ('41261', u'0-2岁'),
    ('8974', u'0-18个月'): ('41261', u'0-2岁'),
    ('83207', u'2岁以下'): ('41261', u'0-2岁'),
    ('69535', u'婴幼儿'): ('41261', u'0-2岁'),
    ('48839', u'2-3岁'): ('48839', u'2-3岁'),
    ('109165', u'2岁'): ('48839', u'2-3岁'),
    ('48849', u'24-36个月'): ('48839', u'2-3岁'),
    ('109245', u'3岁'): ('48839', u'2-3岁'),
    ('43540', u'1-3岁'): ('43540', u'1-3岁'),
    ('73951', u'1~3岁'): ('43540', u'1-3岁'),
    ('8099', u'12-36个月'): ('43540', u'1-3岁'),
    ('101473', u'18-36个月'): ('43540', u'1-3岁'),
    ('67179', u'12-24个月'): ('43540', u'1-3岁'),
    ('48840', u'3-5岁'): ('19872', u'3-6岁'),
    ('19872', u'3-6岁'): ('19872', u'3-6岁'),
    ('73952', u'3~6岁'): ('19872', u'3-6岁'),
    ('67401', u'小童（3-6岁）'): ('19872', u'3-6岁'),
    ('67175', u'4-5岁'): ('19872', u'3-6岁'),
    ('67194', u'4-6岁'): ('19872', u'3-6岁'),
    ('109246', u'4岁'): ('19872', u'3-6岁'),
    ('109247', u'5岁'): ('19872', u'3-6岁'),
    ('109248', u'6岁'): ('19872', u'3-6岁'),
    ('47968', u'0-6岁'): ('47968', u'0-6岁'),
    ('80403', u'5岁以下'): ('47968', u'0-6岁'),
    ('67182', u'0-5岁'): ('47968', u'0-6岁'),
    ('85976', u'6岁以下'): ('47968', u'0-6岁'),
    ('67165', u'0-7岁'): ('47968', u'0-6岁'),
    ('109495', u'4岁以内'): ('47968', u'0-6岁'),
    ('67181', u'0-4岁'): ('47968', u'0-6岁'),
    ('67183', u'0-8岁'): ('47968', u'0-6岁'),
    ('67197', u'6-9岁'): ('67197', u'6-9岁'),
    ('67177', u'6-7岁'): ('67197', u'6-9岁'),
    ('18113', u'6-10岁'): ('67197', u'6-9岁'),
    ('73953', u'6~10岁'): ('67197', u'6-9岁'),
    ('41263', u'7-10岁'): ('67197', u'6-9岁'),
    ('48842', u'5-8岁'): ('67197', u'6-9岁'),
    ('80409', u'7-9岁'): ('67197', u'6-9岁'),
    ('67196', u'6-8岁'): ('67197', u'6-9岁'),
    ('109448', u'7岁'): ('67197', u'6-9岁'),
    ('109249', u'8岁'): ('67197', u'6-9岁'),
    ('109250', u'9岁'): ('67197', u'6-9岁'),
    ('96625', u'9-12岁'): ('96625', u'9-12岁'),
    ('109252', u'11岁'): ('96625', u'9-12岁'),
    ('109253', u'12岁'): ('96625', u'9-12岁'),
    ('18114', u'10-15岁'): ('96625', u'9-12岁'),
    ('109251', u'10岁'): ('96625', u'9-12岁'),
    ('80410', u'10-12岁'): ('96625', u'9-12岁'),
    ('85977', u'10-14岁'): ('96625', u'9-12岁'),
    ('67198', u'8-10岁'): ('96625', u'9-12岁'),
    ('80402', u'9-11岁'): ('96625', u'9-12岁'),
    ('67331', u'6-12岁'): ('67331', u'6-12岁'),
    ('86148', u'4-12岁'): ('67331', u'6-12岁'),
    ('23329', u'4岁-12岁'): ('67331', u'6-12岁'),
    ('95166', u'3-14岁'): ('67331', u'6-12岁'),
    ('47966', u'3-12岁'): ('67331', u'6-12岁'),
    ('70699', u'儿童'): ('67331', u'6-12岁'),
    ('80396', u'7-13岁'): ('67331', u'6-12岁'),
    ('48905', u'7-12岁'): ('67331', u'6-12岁'),
    ('67402', u'大童（6-12岁）'): ('67331', u'6-12岁'),
    ('97067', u'7-14周岁'): ('67331', u'6-12岁'),
    ('86139', u'7-14岁'): ('67331', u'6-12岁'),
    ('77415', u'5-12岁'): ('67331', u'6-12岁'),
    ('47420', u'0-12岁'): ('47420', u'0-12岁'),
    ('94028', u'12-18岁'): ('94028', u'12-18岁'),
    ('87690', u'13-18岁'): ('94028', u'12-18岁'),
    ('67403', u'少年（12岁-18岁）'): ('94028', u'12-18岁'),
    ('97066', u'15-19周岁'): ('94028', u'12-18岁'),
    ('109449', u'13岁'): ('94028', u'12-18岁'),
    ('109450', u'14岁'): ('94028', u'12-18岁'),
    ('89364', u'11-15岁'): ('94028', u'12-18岁'),
    ('80401', u'12-14岁'): ('94028', u'12-18岁'),
    ('79991', u'10-20岁'): ('94028', u'12-18岁'),
    ('47970', u'6个月以上'): ('47970', u'6个月以上'),
    ('66424', u'12个月以上'): ('47970', u'6个月以上'),
    ('43541', u'3岁以上'): ('43541', u'3岁以上'),
    ('67036', u'24个月以上'): ('43541', u'3岁以上'),
    ('77683', u'2岁以上儿童'): ('43541', u'3岁以上'),
    ('77684', u'3岁以上儿童'): ('43541', u'3岁以上'),
    ('8100', u'36个月以上'): ('43541', u'3岁以上'),
    ('67168', u'6岁以上'): ('67168', u'6岁以上'),
    ('109468', u'7岁以上'): ('67168', u'6岁以上'),
    ('77686', u'5岁以上儿童'): ('67168', u'6岁以上'),
    ('77685', u'4岁以上儿童'): ('67168', u'6岁以上'),
    ('48844', u'12岁以上'): ('48844', u'12岁以上'),
    ('86149', u'12以上'): ('48844', u'12岁以上'),
    ('80397', u'14岁以上'): ('48844', u'12岁以上'),
    ('67384', u'10岁以上'): ('48844', u'12岁以上'),
    ('94029', u'18岁以上'): ('94029', u'18岁以上'),
    ('89365', u'16岁以上'): ('94029', u'18岁以上'),
    ('96448', u'17岁以下'): ('96448', u'17岁以下'),
    ('80749', u'17周岁以下'): ('96448', u'17岁以下')
  }
  if age_attr_value in age_map:
    return age_map[age_attr_value]
  else:
    return None


def searchAge(min_age, max_age):
  minimun = 1e-12
  ages = [
    ('96448', u'17岁以下'),
    ('48845', u'0-1个月'),
    ('67242', u'1-3个月'),
    ('67187', u'0-3个月'),
    ('67188', u'3-6个月'),
    ('10096', u'0-6个月'),
    ('48847', u'6-9个月'),
    ('82228', u'10-12个月'),
    ('10097', u'6-12个月'),
    ('67253', u'0-1岁'),
    ('47421', u'12-18个月'),
    ('47422', u'18-24个月'),
    ('41261', u'0-2岁'),
    ('48839', u'2-3岁'),
    ('43540', u'1-3岁'),
    ('19872', u'3-6岁'),
    ('47968', u'0-6岁'),
    ('67197', u'6-9岁'),
    ('96625', u'9-12岁'),
    ('67331', u'6-12岁'),
    ('47420', u'0-12岁'),
    ('94028', u'12-18岁'),
    ('47970', u'6个月以上'),
    ('43541', u'3岁以上'),
    ('67168', u'6岁以上'),
    ('48844', u'12岁以上'),
    ('94029', u'18岁以上')
  ]
  diffs = []
  for age in ages:
    bound = list(map(lambda x: float(x), re.compile(r'\d+\.?\d*').findall(age[1])))
    if age[1][-1] == u'下':
      diff = abs(min_age) / minimun + abs(max_age - bound[0]) / (bound[0] + minimun)
    elif age[1][-1] == u'月':
      diff = abs(min_age - bound[0] / 12) / (bound[0] / 12 + minimun) + abs(max_age - bound[1] / 12) / (bound[1] / 12 + minimun)
    elif age[1][-1] == u'岁':
      diff = abs(min_age - bound[0]) / (bound[0] + minimun) + abs(max_age - bound[1]) / (bound[1] + minimun)
    elif age[1][-3] == u'月':
      diff = abs(min_age - bound[0] / 12) / (bound[0] / 12 + minimun) + abs(max_age - 100) / (100 + minimun)
    else:
      diff = abs(min_age - bound[0]) / (bound[0] + minimun) + abs(max_age - 100) / (100 + minimun)
    diffs.append(diff)
  return ages[diffs.index(min(diffs))]


